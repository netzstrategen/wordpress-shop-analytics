"use strict";!function(e){function t(){if(l.length){var e=u.checkout.dataInit;e.ecommerce.checkout.actionField.step=1,e.ecommerce.checkout.products=u.getProductsData(l),localStorage.setItem("productsInCartData",JSON.stringify(u.getProductsData(l))),u.postToDataLayer(e)}}function c(){u.updateCartItemsQuantity(l),localStorage.setItem("productsInCartData",JSON.stringify(u.getProductsData(l)))}function o(){var t=e(u.cart.elements.shippingMethodSelected);if(t){var c="",o="";if(t.is("select"))o=t.find("option:selected").text();else{if("radio"!==t.attr("type"))return;if(!(c=t.attr("id")))return;o=e('label[for="'+c+'"]').text()}d(shop_analytics_checkout_steps.order,o)}}function s(){localStorage.setItem("shop-analytics-tracked-orders",JSON.stringify([]))}function a(){if(h)return void(h=!1);var t=e(u.checkout.elements.paymentMethodSelected).attr("id");t&&d(shop_analytics_checkout_steps.order,e('label[for="'+t+'"]').text())}function r(){JSON.parse(localStorage.getItem("productsInCartData"))&&i(e(u.checkout.elements.billingAddressFieldsRequired))&&d(shop_analytics_checkout_steps.order)}function n(){if(JSON.parse(localStorage.getItem("productsInCartData"))&&i(e(u.checkout.elements.shippingAddressFieldsRequired))){var t=e(u.checkout.elements.shippingAddressToggle).is(":checked")?u.checkout.messages.shipToDifferentAddress:u.checkout.messages.shipToSameAddress;d(shop_analytics_checkout_steps.order,t)}}function i(t){var c=!0;return t.each(function(){e(this).val().trim().length||(c=!1)}),c}function d(e,t){var c=JSON.parse(localStorage.getItem("productsInCartData"));if(c){var o=u.checkout.dataInit;o.ecommerce.checkout.actionField.step=e,t&&(o.ecommerce.checkout.option=t.trim()),o.ecommerce.checkout.products=c,u.postToDataLayer(o)}}var u=document.shopAnalytics,l=e(u.cart.elements.product),h=!0;e(t),e(document.body).on("updated_cart_totals",c).on("updated_shipping_method",o).on("payment_method_selected",a).on("change",u.checkout.elements.billingAddressFields,r).on("change",u.checkout.elements.shippingAddressFields,n),e("form.checkout").on("change",u.checkout.elements.shippingMethods,o).on("click",u.checkout.elements.checkoutPlaceOrderButton,s)}(jQuery);
